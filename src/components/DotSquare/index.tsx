import React, { useEffect, useRef } from "react";
import gsap from "gsap";
import styles from "./dot-square.module.scss";

interface DotSquareProps {
  color: string;
  width?: string | number;
  height?: string | number;
}

export default function DotSquare({
  color,
  width,
  height,
}: DotSquareProps): JSX.Element {
  const dotSquareRef = useRef<HTMLDivElement | null>(null);
  const svgRef = useRef<SVGSVGElement | null>(null);

  const widthBox =
    typeof width === "number" ? width : parseFloat(width as string) || 100;
  const heightBox =
    typeof height === "number" ? height : parseFloat(height as string) || 100;
  const widthSvg =
    (typeof width === "number" ? width : parseFloat(width as string) || 100) *
    0.8;
  const heightSvg =
    (typeof height === "number"
      ? height
      : parseFloat(height as string) || 100) * 0.8;

  useEffect(() => {
    const dotSquare = dotSquareRef.current;
    const svg = svgRef.current;
    if (!dotSquare || !svg) return;

    const getRandomPosition = () => ({
      x: Math.random() * (widthBox - widthSvg),
      y: Math.random() * (heightBox - heightSvg),
    });

    // Define the animation
    const floatRandomly = (): void => {
      const { x, y } = getRandomPosition();

      gsap.to(svg, {
        x: x,
        y: y,
        duration: 1.5,
        ease: "power1.inOut",
        onComplete: floatRandomly,
      });
    };

    floatRandomly();
  }, [heightBox, heightSvg, widthBox, widthSvg]);

  return (
    <div
      className={styles.dotSquare}
      style={{ width: widthBox, height: heightBox }}
      ref={dotSquareRef}
    >
      <svg
        className={styles.dotSquare__svg}
        width={widthSvg}
        height={heightSvg}
        ref={svgRef}
        viewBox="0 0 54 57"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          fillRule="evenodd"
          clipRule="evenodd"
          d="M52.4631 56.471C51.6145 56.471 50.9265 55.7877 50.9265 54.9448C50.9265 54.1019 51.6145 53.4185 52.4631 53.4185C53.3118 53.4185 53.9997 54.1019 53.9997 54.9448C53.9997 55.7877 53.3118 56.471 52.4631 56.471ZM52.4631 45.7874C51.6145 45.7874 50.9265 45.104 50.9265 44.2611C50.9265 43.4182 51.6145 42.7349 52.4631 42.7349C53.3118 42.7349 53.9997 43.4182 53.9997 44.2611C53.9997 45.104 53.3118 45.7874 52.4631 45.7874ZM52.4631 35.1034C51.6145 35.1034 50.9265 34.4201 50.9265 33.5772C50.9265 32.7343 51.6145 32.0509 52.4631 32.0509C53.3118 32.0509 53.9997 32.7343 53.9997 33.5772C53.9997 34.4201 53.3118 35.1034 52.4631 35.1034ZM52.4631 24.4199C51.6145 24.4199 50.9265 23.7366 50.9265 22.8936C50.9265 22.0507 51.6145 21.3674 52.4631 21.3674C53.3118 21.3674 53.9997 22.0507 53.9997 22.8936C53.9997 23.7366 53.3118 24.4199 52.4631 24.4199ZM52.4631 13.7361C51.6145 13.7361 50.9265 13.0528 50.9265 12.2099C50.9265 11.367 51.6145 10.6836 52.4631 10.6836C53.3118 10.6836 53.9997 11.367 53.9997 12.2099C53.9997 13.0528 53.3118 13.7361 52.4631 13.7361ZM52.4631 3.05248C51.6145 3.05248 50.9265 2.36916 50.9265 1.52624C50.9265 0.683321 51.6145 0 52.4631 0C53.3118 0 53.9997 0.683321 53.9997 1.52624C53.9997 2.36916 53.3118 3.05248 52.4631 3.05248ZM42.3665 56.471C41.5178 56.471 40.8299 55.7877 40.8299 54.9448C40.8299 54.1019 41.5178 53.4185 42.3665 53.4185C43.2151 53.4185 43.903 54.1019 43.903 54.9448C43.903 55.7877 43.2151 56.471 42.3665 56.471ZM42.3665 45.7874C41.5178 45.7874 40.8299 45.104 40.8299 44.2611C40.8299 43.4182 41.5178 42.7349 42.3665 42.7349C43.2151 42.7349 43.903 43.4182 43.903 44.2611C43.903 45.104 43.2151 45.7874 42.3665 45.7874ZM42.3665 35.1034C41.5178 35.1034 40.8299 34.4201 40.8299 33.5772C40.8299 32.7343 41.5178 32.0509 42.3665 32.0509C43.2151 32.0509 43.903 32.7343 43.903 33.5772C43.903 34.4201 43.2151 35.1034 42.3665 35.1034ZM42.3665 24.4199C41.5178 24.4199 40.8299 23.7366 40.8299 22.8936C40.8299 22.0507 41.5178 21.3674 42.3665 21.3674C43.2151 21.3674 43.903 22.0507 43.903 22.8936C43.903 23.7366 43.2151 24.4199 42.3665 24.4199ZM42.3665 13.7361C41.5178 13.7361 40.8299 13.0528 40.8299 12.2099C40.8299 11.367 41.5178 10.6836 42.3665 10.6836C43.2151 10.6836 43.903 11.367 43.903 12.2099C43.903 13.0528 43.2151 13.7361 42.3665 13.7361ZM42.3665 3.05248C41.5178 3.05248 40.8299 2.36916 40.8299 1.52624C40.8299 0.683321 41.5178 0 42.3665 0C43.2151 0 43.903 0.683321 43.903 1.52624C43.903 2.36916 43.2151 3.05248 42.3665 3.05248ZM32.2682 56.471C31.4196 56.471 30.7316 55.7877 30.7316 54.9448C30.7316 54.1019 31.4196 53.4185 32.2682 53.4185C33.1168 53.4185 33.8048 54.1019 33.8048 54.9448C33.8048 55.7877 33.1168 56.471 32.2682 56.471ZM32.2682 45.7874C31.4196 45.7874 30.7316 45.104 30.7316 44.2611C30.7316 43.4182 31.4196 42.7349 32.2682 42.7349C33.1168 42.7349 33.8048 43.4182 33.8048 44.2611C33.8048 45.104 33.1168 45.7874 32.2682 45.7874ZM32.2682 35.1034C31.4196 35.1034 30.7316 34.4201 30.7316 33.5772C30.7316 32.7343 31.4196 32.0509 32.2682 32.0509C33.1168 32.0509 33.8048 32.7343 33.8048 33.5772C33.8048 34.4201 33.1168 35.1034 32.2682 35.1034ZM32.2682 24.4199C31.4196 24.4199 30.7316 23.7366 30.7316 22.8936C30.7316 22.0507 31.4196 21.3674 32.2682 21.3674C33.1168 21.3674 33.8048 22.0507 33.8048 22.8936C33.8048 23.7366 33.1168 24.4199 32.2682 24.4199ZM32.2682 13.7361C31.4196 13.7361 30.7316 13.0528 30.7316 12.2099C30.7316 11.367 31.4196 10.6836 32.2682 10.6836C33.1168 10.6836 33.8048 11.367 33.8048 12.2099C33.8048 13.0528 33.1168 13.7361 32.2682 13.7361ZM32.2682 3.05248C31.4196 3.05248 30.7316 2.36916 30.7316 1.52624C30.7316 0.683321 31.4196 0 32.2682 0C33.1168 0 33.8048 0.683321 33.8048 1.52624C33.8048 2.36916 33.1168 3.05248 32.2682 3.05248ZM21.7323 56.471C20.8837 56.471 20.1957 55.7877 20.1957 54.9448C20.1957 54.1019 20.8837 53.4185 21.7323 53.4185C22.581 53.4185 23.2689 54.1019 23.2689 54.9448C23.2689 55.7877 22.581 56.471 21.7323 56.471ZM21.7323 45.7874C20.8837 45.7874 20.1957 45.104 20.1957 44.2611C20.1957 43.4182 20.8837 42.7349 21.7323 42.7349C22.581 42.7349 23.2689 43.4182 23.2689 44.2611C23.2689 45.104 22.581 45.7874 21.7323 45.7874ZM21.7323 35.1034C20.8837 35.1034 20.1957 34.4201 20.1957 33.5772C20.1957 32.7343 20.8837 32.0509 21.7323 32.0509C22.581 32.0509 23.2689 32.7343 23.2689 33.5772C23.2689 34.4201 22.581 35.1034 21.7323 35.1034ZM21.7323 24.4199C20.8837 24.4199 20.1957 23.7366 20.1957 22.8936C20.1957 22.0507 20.8837 21.3674 21.7323 21.3674C22.581 21.3674 23.2689 22.0507 23.2689 22.8936C23.2689 23.7366 22.581 24.4199 21.7323 24.4199ZM21.7323 13.7361C20.8837 13.7361 20.1957 13.0528 20.1957 12.2099C20.1957 11.367 20.8837 10.6836 21.7323 10.6836C22.581 10.6836 23.2689 11.367 23.2689 12.2099C23.2689 13.0528 22.581 13.7361 21.7323 13.7361ZM21.7323 3.05248C20.8837 3.05248 20.1957 2.36916 20.1957 1.52624C20.1957 0.683321 20.8837 0 21.7323 0C22.581 0 23.2689 0.683321 23.2689 1.52624C23.2689 2.36916 22.581 3.05248 21.7323 3.05248ZM11.6341 56.471C10.7854 56.471 10.0975 55.7877 10.0975 54.9448C10.0975 54.1019 10.7854 53.4185 11.6341 53.4185C12.4827 53.4185 13.1707 54.1019 13.1707 54.9448C13.1707 55.7877 12.4827 56.471 11.6341 56.471ZM11.6341 45.7874C10.7854 45.7874 10.0975 45.104 10.0975 44.2611C10.0975 43.4182 10.7854 42.7349 11.6341 42.7349C12.4827 42.7349 13.1707 43.4182 13.1707 44.2611C13.1707 45.104 12.4827 45.7874 11.6341 45.7874ZM11.6341 35.1034C10.7854 35.1034 10.0975 34.4201 10.0975 33.5772C10.0975 32.7343 10.7854 32.0509 11.6341 32.0509C12.4827 32.0509 13.1707 32.7343 13.1707 33.5772C13.1707 34.4201 12.4827 35.1034 11.6341 35.1034ZM11.6341 24.4199C10.7854 24.4199 10.0975 23.7366 10.0975 22.8936C10.0975 22.0507 10.7854 21.3674 11.6341 21.3674C12.4827 21.3674 13.1707 22.0507 13.1707 22.8936C13.1707 23.7366 12.4827 24.4199 11.6341 24.4199ZM11.6341 13.7361C10.7854 13.7361 10.0975 13.0528 10.0975 12.2099C10.0975 11.367 10.7854 10.6836 11.6341 10.6836C12.4827 10.6836 13.1707 11.367 13.1707 12.2099C13.1707 13.0528 12.4827 13.7361 11.6341 13.7361ZM11.6341 3.05248C10.7854 3.05248 10.0975 2.36916 10.0975 1.52624C10.0975 0.683321 10.7854 0 11.6341 0C12.4827 0 13.1707 0.683321 13.1707 1.52624C13.1707 2.36916 12.4827 3.05248 11.6341 3.05248ZM1.53659 56.471C0.687957 56.471 0 55.7877 0 54.9448C0 54.1019 0.687957 53.4185 1.53659 53.4185C2.38523 53.4185 3.07319 54.1019 3.07319 54.9448C3.07319 55.7877 2.38523 56.471 1.53659 56.471ZM1.53659 45.7874C0.687957 45.7874 0 45.104 0 44.2611C0 43.4182 0.687957 42.7349 1.53659 42.7349C2.38523 42.7349 3.07319 43.4182 3.07319 44.2611C3.07319 45.104 2.38523 45.7874 1.53659 45.7874ZM1.53659 35.1034C0.687957 35.1034 0 34.4201 0 33.5772C0 32.7343 0.687957 32.0509 1.53659 32.0509C2.38523 32.0509 3.07319 32.7343 3.07319 33.5772C3.07319 34.4201 2.38523 35.1034 1.53659 35.1034ZM1.53659 24.4199C0.687957 24.4199 0 23.7366 0 22.8936C0 22.0507 0.687957 21.3674 1.53659 21.3674C2.38523 21.3674 3.07319 22.0507 3.07319 22.8936C3.07319 23.7366 2.38523 24.4199 1.53659 24.4199ZM1.53659 13.7361C0.687957 13.7361 0 13.0528 0 12.2099C0 11.367 0.687957 10.6836 1.53659 10.6836C2.38523 10.6836 3.07319 11.367 3.07319 12.2099C3.07319 13.0528 2.38523 13.7361 1.53659 13.7361ZM1.53659 3.05248C0.687957 3.05248 0 2.36916 0 1.52624C0 0.683321 0.687957 0 1.53659 0C2.38523 0 3.07319 0.683321 3.07319 1.52624C3.07319 2.36916 2.38523 3.05248 1.53659 3.05248Z"
          fill={color}
        />
      </svg>
    </div>
  );
}
